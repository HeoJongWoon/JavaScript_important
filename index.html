<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>복수개의 Promise객체를 동기화 처리</title>
</head>

<body>
  <script>
    //이미지소스 로딩완료 체크 함수
    const getImgs = boolean => {
      return new Promise((res, rej) => {
        setTimeout(() => {
          boolean ? res('img loaded') : rej('img fail');
        }, 2000);
      })
    }

    //영상소스 로딩완료 체크 함수
    const getVids = boolean => new Promise((res, rej) => setTimeout(() => boolean ? res('vid loaded') : rej('vid fail'), 2000));

    //Promise.all은 인수로 전달되는 모든 값이 프로미스 객체에서 resolve 반환해야 then이 실행 그렇지 않으면 catch문   
    //const loadedSrc = Promise.all([getImgs(true), getVids(false)])

    //Promise.race는 인수로 전달되는 값이 하나라도 프로미스 객체에서 resolve를 반환하면 then이 실행되고 모두 reject를 반환해야 catch실행
    const loadedSrc = Promise.race([getImgs(false), getVids(false)]);
    loadedSrc
      .then(val => console.log('로딩완료', val))
      .catch(err => console.log('로딩실패', err))
      .finally(() => console.log('complete'))

  </script>